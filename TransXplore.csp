<html>
<head>
<title> TransXplore </title>
</head>

<body bgcolor=lightgreen onload=#server(..DATEH())#>
<form name="TransXplore" method="post" action="">

<span id="C1" style="position:absolute; z-index: 3; left:60px; top:20px;">IRM 1</span>
<span id="C2" style="position:absolute; z-index: 3; left:180px; top:20px;">IRM 2</span>
<span id="C7" style="position:absolute; z-index: 3; left:300px; top:20px;">IRM T1</span>

<span id="T1" style="position:absolute; z-index: 3; left:10px; top:40px;">FTI</span>
<input type="text" name="FTI1" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:40px;">
<input type="text" name="FTI2" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:40px;">
<input type="text" name="FTI3" value="" size=10 style="position:absolute; z-index: 3; left:300px; top:40px;">
<span id="T2" style="position:absolute; z-index: 3; left:10px; top:62px;">FTRI1</span>
<input type="text" name="FTRI11" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:62px;">
<input type="text" name="FTRI12" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:62px;">
<input type="text" name="FTRI13" value="" size=10 style="position:absolute; z-index: 3; left:300px; top:62px;">
<span id="T3" style="position:absolute; z-index: 3; left:10px; top:84px;">FTRI2</span>
<input type="text" name="FTRI21" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:84px;">
<input type="text" name="FTRI22" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:84px;">
<input type="text" name="FTRI23" value="" size=10 style="position:absolute; z-index: 3; left:300px; top:84px;">
<span id="T4" style="position:absolute; z-index: 3; left:10px; top:106px;">FTRI3</span>
<input type="text" name="FTRI31" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:106px;">
<input type="text" name="FTRI32" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:106px;">
<input type="text" name="FTRI33" value="" size=10 style="position:absolute; z-index: 3; left:300px; top:106px;">
<span id="T5" style="position:absolute; z-index: 3; left:10px; top:128px;">FTV</span>
<input type="text" name="FTV1" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:128px;">
<input type="text" name="FTV2" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:128px;">
<input type="text" name="FTV3" value="" size=10 style="position:absolute; z-index: 3; left:300px; top:128px;">
<span id="T6" style="position:absolute; z-index: 3; left:10px; top:150px;">FTVG</span>
<input type="text" name="FTVG1" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:150px;">
<input type="text" name="FTVG2" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:150px;">
<input type="text" name="FTVG3" value="" size=10 style="position:absolute; z-index: 3; left:300px; top:150px;">
<span id="T7" style="position:absolute; z-index: 3; left:10px; top:172px;">FTVN</span>
<input type="text" name="FTVN1" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:172px;">
<input type="text" name="FTVN2" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:172px;">
<input type="text" name="FTVN3" value="" size=10 style="position:absolute; z-index: 3; left:300px; top:172px;">

<span id="C3" style="position:absolute; z-index: 3; left:60px; top:210px;">SCANNER 1</span>
<span id="C4" style="position:absolute; z-index: 3; left:180px; top:210px;">SCANNER 3</span>

<span id="T8" style="position:absolute; z-index: 3; left:10px; top:230px;">FTS</span>
<input type="text" name="FTS1" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:230px;">
<input type="text" name="FTS2" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:230px;">
<span id="T9" style="position:absolute; z-index: 3; left:10px; top:252px;">FTRS1</span>
<input type="text" name="FTRS11" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:252px;">
<input type="text" name="FTRS12" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:252px;">
<span id="T10" style="position:absolute; z-index: 3; left:10px; top:274px;">FTRS2</span>
<input type="text" name="FTRS21" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:274px;">
<input type="text" name="FTRS22" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:274px;">
<span id="T11" style="position:absolute; z-index: 3; left:10px; top:296px;">FTRS3</span>
<input type="text" name="FTRS31" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:296px;">
<input type="text" name="FTRS32" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:296px;">
<span id="T12" style="position:absolute; z-index: 3; left:10px; top:318px;">FTU</span>
<input type="text" name="FTU1" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:318px;">
<input type="text" name="FTU2" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:318px;">
<span id="T13" style="position:absolute; z-index: 3; left:10px; top:340px;">FTW</span>
<input type="text" name="FTW1" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:340px;">
<input type="text" name="FTW2" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:340px;">
<span id="T14" style="position:absolute; z-index: 3; left:10px; top:362px;">FTWG</span>
<input type="text" name="FTWG1" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:362px;">
<input type="text" name="FTWG2" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:362px;">
<span id="T15" style="position:absolute; z-index: 3; left:10px; top:384px;">FTUE</span>
<input type="text" name="FTUE1" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:384px;">
<input type="text" name="FTUE2" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:384px;">
<span id="T16" style="position:absolute; z-index: 3; left:10px; top:406px;">FTUG</span>
<input type="text" name="FTUG1" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:406px;">
<input type="text" name="FTUG2" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:406px;">
<span id="T17" style="position:absolute; z-index: 3; left:10px; top:428px;">FTUN</span>
<input type="text" name="FTUN1" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:428px;">
<input type="text" name="FTUN2" value="" size=10 style="position:absolute; z-index: 3; left:180px; top:428px;">


<span id="C5" style="position:absolute; z-index: 3; left:60px; top:466px;">PETSCANNER 2</span>

<span id="T18" style="position:absolute; z-index: 3; left:10px; top:486px;">FTP</span>
<input type="text" name="FTP" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:486px;">
<span id="T19" style="position:absolute; z-index: 3; left:10px; top:508px;">FTRP1</span>
<input type="text" name="FTRP1" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:508px;">
<span id="T20" style="position:absolute; z-index: 3; left:10px; top:530px;">FTX</span>
<input type="text" name="FTX" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:530px;">
<span id="T21" style="position:absolute; z-index: 3; left:10px; top:552px;">FTXG</span>
<input type="text" name="FTXG" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:552px;">
<span id="T22" style="position:absolute; z-index: 3; left:10px; top:574px;">FTXN</span>
<input type="text" name="FTXN" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:574px;">
<span id="T23" style="position:absolute; z-index: 3; left:10px; top:596px;">FTXS</span>
<input type="text" name="FTXS" value="" size=10 style="position:absolute; z-index: 3; left:60px; top:596px;">

<span id="C6" style="position:absolute; z-index: 3; left:280px; top:466px;">PETSCANNER 2_2</span>

<span id="T18" style="position:absolute; z-index: 3; left:210px; top:486px;">FTP_2</span>
<input type="text" name="FTP2" value="" size=10 style="position:absolute; z-index: 3; left:280px; top:486px;">
<span id="T19" style="position:absolute; z-index: 3; left:210px; top:508px;">FTRP1_2</span>
<input type="text" name="FTRP12" value="" size=10 style="position:absolute; z-index: 3; left:280px; top:508px;">
<span id="T20" style="position:absolute; z-index: 3; left:210px; top:530px;">FTX_2</span>
<input type="text" name="FTX2" value="" size=10 style="position:absolute; z-index: 3; left:280px; top:530px;">
<span id="T21" style="position:absolute; z-index: 3; left:210px; top:552px;">FTXG_2</span>
<input type="text" name="FTXG2" value="" size=10 style="position:absolute; z-index: 3; left:280px; top:552px;">
<span id="T22" style="position:absolute; z-index: 3; left:210px; top:574px;">FTXN_2</span>
<input type="text" name="FTXN2" value="" size=10 style="position:absolute; z-index: 3; left:280px; top:574px;">
<span id="T23" style="position:absolute; z-index: 3; left:210px; top:596px;">FTXS_2</span>
<input type="text" name="FTXS2" value="" size=10 style="position:absolute; z-index: 3; left:280px; top:596px;">


<input type="button" value="Enregistrer dans l'année en cours" style="position:absolute; z-index: 3; left:60px; top:650px; border-radius: 8px;" onclick="salvax()">
<input type="button" value="Enregistrer pour l'année prochaine" style="position:absolute; z-index: 3; left:300px; top:650px; border-radius: 8px;" onclick="salvax2()">

<script type='text/javascript'>
function salvax() {
var info1=document.TransXplore.FTI1.value+'^'+document.TransXplore.FTRI11.value+'^'+document.TransXplore.FTRI21.value+'^'+document.TransXplore.FTRI31.value+'^'+document.TransXplore.FTV1.value+'^'+document.TransXplore.FTVG1.value+'^'+document.TransXplore.FTVN1.value;
var info2=document.TransXplore.FTI2.value+'^'+document.TransXplore.FTRI12.value+'^'+document.TransXplore.FTRI22.value+'^'+document.TransXplore.FTRI32.value+'^'+document.TransXplore.FTV2.value+'^'+document.TransXplore.FTVG2.value+'^'+document.TransXplore.FTVN2.value;
var info7=document.TransXplore.FTI3.value+'^'+document.TransXplore.FTRI13.value+'^'+document.TransXplore.FTRI23.value+'^'+document.TransXplore.FTRI33.value+'^'+document.TransXplore.FTV3.value+'^'+document.TransXplore.FTVG3.value+'^'+document.TransXplore.FTVN3.value;

var info3=document.TransXplore.FTS1.value+'^'+document.TransXplore.FTRS11.value+'^'+document.TransXplore.FTRS21.value+'^'+document.TransXplore.FTRS31.value+'^'+document.TransXplore.FTU1.value+'^'+document.TransXplore.FTW1.value+'^'+document.TransXplore.FTWG1.value+'^'+document.TransXplore.FTUE1.value+'^'+document.TransXplore.FTUG1.value+'^'+document.TransXplore.FTUN1.value;
var info4=document.TransXplore.FTS2.value+'^'+document.TransXplore.FTRS21.value+'^'+document.TransXplore.FTRS22.value+'^'+document.TransXplore.FTRS32.value+'^'+document.TransXplore.FTU2.value+'^'+document.TransXplore.FTW2.value+'^'+document.TransXplore.FTWG2.value+'^'+document.TransXplore.FTUE2.value+'^'+document.TransXplore.FTUG2.value+'^'+document.TransXplore.FTUN2.value;
var info5=document.TransXplore.FTP.value+'^'+document.TransXplore.FTRP1.value+'^'+document.TransXplore.FTX.value+'^'+document.TransXplore.FTXG.value+'^'+document.TransXplore.FTXN.value+'^'+document.TransXplore.FTXS.value;
var info6=document.TransXplore.FTP2.value+'^'+document.TransXplore.FTRP12.value+'^'+document.TransXplore.FTX2.value+'^'+document.TransXplore.FTXG2.value+'^'+document.TransXplore.FTXN2.value+'^'+document.TransXplore.FTXS2.value;
#server(..salvara(info1,info2,info3,info4,info5,info6,info7))#
return false; }
</script>

<script type='text/javascript'>
function salvax2() {
var info1=document.TransXplore.FTI1.value+'^'+document.TransXplore.FTRI11.value+'^'+document.TransXplore.FTRI21.value+'^'+document.TransXplore.FTRI31.value+'^'+document.TransXplore.FTV1.value+'^'+document.TransXplore.FTVG1.value+'^'+document.TransXplore.FTVN1.value;
var info2=document.TransXplore.FTI2.value+'^'+document.TransXplore.FTRI12.value+'^'+document.TransXplore.FTRI22.value+'^'+document.TransXplore.FTRI32.value+'^'+document.TransXplore.FTV2.value+'^'+document.TransXplore.FTVG2.value+'^'+document.TransXplore.FTVN2.value;
var info7=document.TransXplore.FTI3.value+'^'+document.TransXplore.FTRI13.value+'^'+document.TransXplore.FTRI23.value+'^'+document.TransXplore.FTRI33.value+'^'+document.TransXplore.FTV3.value+'^'+document.TransXplore.FTVG3.value+'^'+document.TransXplore.FTVN3.value;

var info3=document.TransXplore.FTS1.value+'^'+document.TransXplore.FTRS11.value+'^'+document.TransXplore.FTRS21.value+'^'+document.TransXplore.FTRS31.value+'^'+document.TransXplore.FTU1.value+'^'+document.TransXplore.FTW1.value+'^'+document.TransXplore.FTWG1.value+'^'+document.TransXplore.FTUE1.value+'^'+document.TransXplore.FTUG1.value+'^'+document.TransXplore.FTUN1.value;
var info4=document.TransXplore.FTS2.value+'^'+document.TransXplore.FTRS21.value+'^'+document.TransXplore.FTRS22.value+'^'+document.TransXplore.FTRS32.value+'^'+document.TransXplore.FTU2.value+'^'+document.TransXplore.FTW2.value+'^'+document.TransXplore.FTWG2.value+'^'+document.TransXplore.FTUE2.value+'^'+document.TransXplore.FTUG2.value+'^'+document.TransXplore.FTUN2.value;
var info5=document.TransXplore.FTP.value+'^'+document.TransXplore.FTRP1.value+'^'+document.TransXplore.FTX.value+'^'+document.TransXplore.FTXG.value+'^'+document.TransXplore.FTXN.value+'^'+document.TransXplore.FTXS.value;
var info6=document.TransXplore.FTP2.value+'^'+document.TransXplore.FTRP12.value+'^'+document.TransXplore.FTX2.value+'^'+document.TransXplore.FTXG2.value+'^'+document.TransXplore.FTXN2.value+'^'+document.TransXplore.FTXS2.value;
#server(..salvara2(info1,info2,info3,info4,info5,info6,info7))#
return false; }
</script>


<script language=cache method="DATEH" arguments="">
I '$D(^TransXplore($ZD($H,3)+1)) M ^TransXplore($ZD($H,3)+1)=^TransXplore($ZD($H,3)+0)
S ANOa=$ZD($H,3)+0,ANOp=ANOa-1
S ANO=ANOa I '$D(^TransXplore(ANOa)) S ANO=ANOp
S MAQ="1690" S LET="" F  S LET=$O(^TransXplore(ANO,MAQ,LET)) Q:LET=""  s V=^(LET),LN=LET_"1" &html<document.TransXplore.#(LN)#.value=('#(V)#');>
S MAQ="IRM 2" S LET="" F  S LET=$O(^TransXplore(ANO,MAQ,LET)) Q:LET=""  s V=^(LET),LN=LET_"2" &html<document.TransXplore.#(LN)#.value=('#(V)#');>
S MAQ="IRM T1" S LET="" F  S LET=$O(^TransXplore(ANO,MAQ,LET)) Q:LET=""  s V=^(LET),LN=LET_"3" &html<document.TransXplore.#(LN)#.value=('#(V)#');>
S MAQ="92011502012018" S LET="" F  S LET=$O(^TransXplore(ANO,MAQ,LET)) Q:LET=""  s V=^(LET),LN=LET_"1" &html<document.TransXplore.#(LN)#.value=('#(V)#');>
S MAQ="92011502012022" S LET="" F  S LET=$O(^TransXplore(ANO,MAQ,LET)) Q:LET=""  s V=^(LET),LN=LET_"2" &html<document.TransXplore.#(LN)#.value=('#(V)#');>
S MAQ="PETSCANNER 2" S LET="" F  S LET=$O(^TransXplore(ANO,MAQ,LET)) Q:LET=""  s V=^(LET),LN=LET &html<document.TransXplore.#(LN)#.value=('#(V)#');>
S MAQ="PETSCANNER 2_2" S LET="" F  S LET=$O(^TransXplore(ANO,MAQ,LET)) Q:LET=""  s V=^(LET),LN=$P(LET,"_",1)_$P(LET,"_",2) &html<document.TransXplore.#(LN)#.value=('#(V)#');>
</script>

</form>
</body>

<script language=cache method="salvara" arguments="%INFO1,%INFO2,%INFO3,%INFO4,%INFO5,%INFO6,%INFO7">
K PIECE
F I=1:1:$L(%INFO1,"^") S PIECE("1690",$P("FTI^FTRI1^FTRI2^FTRI3^FTV^FTVG^FTVN","^",I))=$P(%INFO1,"^",I)
F I=1:1:$L(%INFO2,"^") S PIECE("IRM 2",$P("FTI^FTRI1^FTRI2^FTRI3^FTV^FTVG^FTVN","^",I))=$P(%INFO2,"^",I)
F I=1:1:$L(%INFO7,"^") S PIECE("IRM T1",$P("FTI^FTRI1^FTRI2^FTRI3^FTV^FTVG^FTVN","^",I))=$P(%INFO7,"^",I)
F I=1:1:$L(%INFO3,"^") S PIECE("92011502012018",$P("FTS^FTRS1^FTRS2^FTRS3^FTU^FTW^FTWG^FTUE^FTUG^FTUN","^",I))=$P(%INFO3,"^",I)
F I=1:1:$L(%INFO4,"^") S PIECE("92011502012022",$P("FTS^FTRS1^FTRS2^FTRS3^FTU^FTW^FTWG^FTUE^FTUG^FTUN","^",I))=$P(%INFO4,"^",I)
F I=1:1:$L(%INFO5,"^") S PIECE("PETSCANNER 2",$P("FTP^FTRP1^FTX^FTXG^FTXN^FTXS","^",I))=$P(%INFO5,"^",I)
F I=1:1:$L(%INFO6,"^") S PIECE("PETSCANNER 2_2",$P("FTP_2^FTRP1_2^FTX_2^FTXG_2^FTXN_2^FTXS_2","^",I))=$P(%INFO6,"^",I)
M ^TransXplore($ZD($H,3)+0)=PIECE S ^TransXplore($ZD($H,3)+0)=$USERNAME
s retour="Année "_($ZD($H,3)+0)_" mis à jour!"
&html<alert ('#(retour)#');>
</script>

<script language=cache method="salvara2" arguments="%INFO1,%INFO2,%INFO3,%INFO4,%INFO5,%INFO6,%INFO7">
K PIECE
F I=1:1:$L(%INFO1,"^") S PIECE("1690",$P("FTI^FTRI1^FTRI2^FTRI3^FTV^FTVG^FTVN","^",I))=$P(%INFO1,"^",I)
F I=1:1:$L(%INFO2,"^") S PIECE("IRM 2",$P("FTI^FTRI1^FTRI2^FTRI3^FTV^FTVG^FTVN","^",I))=$P(%INFO2,"^",I)
F I=1:1:$L(%INFO7,"^") S PIECE("IRM T1",$P("FTI^FTRI1^FTRI2^FTRI3^FTV^FTVG^FTVN","^",I))=$P(%INFO7,"^",I)
F I=1:1:$L(%INFO3,"^") S PIECE("92011502012018",$P("FTS^FTRS1^FTRS2^FTRS3^FTU^FTW^FTWG^FTUE^FTUG^FTUN","^",I))=$P(%INFO3,"^",I)
F I=1:1:$L(%INFO4,"^") S PIECE("92011502012022",$P("FTS^FTRS1^FTRS2^FTRS3^FTU^FTW^FTWG^FTUE^FTUG^FTUN","^",I))=$P(%INFO4,"^",I)
F I=1:1:$L(%INFO5,"^") S PIECE("PETSCANNER 2",$P("FTP^FTRP1^FTX^FTXG^FTXN^FTXS","^",I))=$P(%INFO5,"^",I)
F I=1:1:$L(%INFO6,"^") S PIECE("PETSCANNER 2_2",$P("FTP_2^FTRP1_2^FTX_2^FTXG_2^FTXN_2^FTXS_2","^",I))=$P(%INFO6,"^",I)
M ^TransXplore($ZD($H,3)+1)=PIECE S ^TransXplore($ZD($H,3)+1)=$USERNAME
s retour="Année "_($ZD($H,3)+1)_" mis à jour!"
&html<alert ('#(retour)#');>
</script>
</html>
